<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZEN.COM – Select Payment Method</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --Background: #FFFFFF;
    --Primary: #222222;
    --Secondary: #727272;
    --Tertiary: #A3A3A3;
    --Disabled: #B5B5B5;
    --SurfaceSuperLight: #FAFAFA;
    --SurfaceLight: #F7F7F7;
    --SurfaceMedium: #EBEBEB;
    --SurfaceStrong: #DFDFDF;
    --GraphSecondary: #CCCCCC;
    --Contrary: #FFFFFF;
  }

  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Nunito', sans-serif;
    background: var(--Background);
    color: var(--Primary);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  .page {
    display: flex;
    width: 1440px;
    margin: 0 auto;
    padding-top: 100px;
    padding-bottom: 60px;
    flex-direction: column;
    align-items: center;
    gap: 142px;
    background: var(--Background);
    flex: 1;
  }

  .content {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 64px;
  }

  /* ── Left column ── */
  .left-col {
    width: 552px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
  }

  .header-row {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-title {
    font-size: 24px;
    font-weight: 700;
    line-height: 32px;
    color: var(--Primary);
  }

  .header-subtitle {
    font-size: 14px;
    font-weight: 500;
    line-height: 18px;
    color: var(--Secondary);
    margin-top: 4px;
  }

  .country-selector {
    display: flex;
    flex-direction: column;
    gap: 2px;
    width: 141px;
  }

  .country-label {
    font-size: 11px;
    font-weight: 400;
    line-height: 14px;
    color: var(--Secondary);
  }

  .country-value-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 20px;
  }

  .country-value {
    font-size: 14px;
    font-weight: 600;
    line-height: 16px;
    color: var(--Primary);
  }

  .country-chevron svg { display: block; }

  .country-underline {
    height: 1px;
    background: var(--Secondary);
    margin-top: 4px;
  }

  /* ── Payment list card ── */
  .payment-card {
    width: 100%;
    border-radius: 24px;
    border: 1px solid var(--SurfaceStrong);
    box-shadow: 0 24px 114px rgba(0,0,0,0.06);
    overflow: visible;
    display: flex;
    flex-direction: column;
  }

  /* First/last child rounding (since overflow:visible) */
  .payment-card > *:first-child {
    border-radius: 24px 24px 0 0;
  }

  .payment-card > *:last-child {
    border-radius: 0 0 24px 24px;
  }

  /* ── Generic payment item ── */
  .payment-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 24px;
    background: var(--Background);
    cursor: pointer;
    transition: background 0.15s;
  }

  .payment-item:hover {
    background: var(--SurfaceSuperLight);
  }

  /* Separators via .payment-separator */
  .payment-separator {
    height: 0;
    border: none;
    border-top: 1px solid var(--SurfaceMedium);
    margin: 0;
    flex-shrink: 0;
    transition: opacity 0.25s ease;
  }

  .payment-item-left {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .pm-icon {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: var(--SurfaceSuperLight);
    border: 1px solid var(--SurfaceMedium);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
  }

  .pm-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .pm-name-row {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .pm-name {
    font-size: 14px;
    font-weight: 700;
    line-height: 18px;
    color: var(--Primary);
  }

  .pm-desc {
    font-size: 11px;
    font-weight: 500;
    line-height: 14px;
    color: var(--Secondary);
  }

  /* ── Expanded Card payment item ── */
  .payment-item-expanded {
    display: flex;
    padding: 24px;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    gap: 16px;
    align-self: stretch;
    border-radius: 20px;
    border: 3px solid var(--Primary);
    background: #FFF;
    /* animation */
    overflow: hidden;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .payment-item-expanded + .payment-item {
    border-top: 1px solid var(--SurfaceMedium);
  }

  .payment-item-expanded .payment-item-left {
    cursor: pointer;
  }

  /* Click to Pay button */
  .c2p-btn {
    display: inline-flex;
    height: 40px;
    min-width: 96px;
    padding: 12px 24px;
    background: var(--Background);
    border-radius: 24px;
    border: 2px solid var(--Primary);
    align-items: center;
    gap: 10px;
    cursor: pointer;
    transition: background .15s;
  }

  .c2p-btn:hover {
    background: var(--SurfaceSuperLight);
  }

  .c2p-brands {
    display: inline-flex;
    padding: 4px 8px;
    background: white;
    border-radius: 4px;
    border: 0.5px solid var(--SurfaceStrong);
    align-items: center;
  }

  .c2p-brands svg { display: block; }

  .c2p-text {
    font-size: 14px;
    font-weight: 700;
    line-height: 16px;
    color: var(--Primary);
    white-space: nowrap;
  }

  /* ── Form fields ── */
  .card-form {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 32px;
  }

  .fields-group {
    display: flex;
    flex-direction: column;
    gap: 20px;
    width: 100%;
  }

  .field {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1 1 0;
  }

  .field-label {
    font-size: 12px;
    font-weight: 400;
    line-height: 16px;
    color: var(--Secondary);
  }

  .field-input-wrap {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .field-input-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 30px;
  }

  .field-input-row input {
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
    font-size: 16px;
    font-family: 'Nunito', sans-serif;
    font-weight: 600;
    line-height: 20px;
    color: var(--Primary);
    padding: 0;
  }

  .field-input-row input::placeholder {
    color: var(--Secondary);
    font-weight: 600;
  }

  .field-input-row input:focus::placeholder {
    color: var(--Tertiary);
  }

  .field-icon {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
    margin-right: 8px;
  }

  .field-action {
    display: flex;
    align-items: center;
    flex-shrink: 0;
  }

  .field-underline {
    height: 1px;
    background: var(--Secondary);
    margin-top: 6px;
    transition: background .2s;
  }

  .field:focus-within .field-underline {
    background: var(--Primary);
    height: 2px;
    margin-top: 5px;
  }

  .field-row {
    display: flex;
    gap: 20px;
  }

  /* ── Checkboxes ── */
  .options-group {
    display: flex;
    flex-direction: column;
    gap: 16px;
    width: 100%;
  }

  .save-card-section {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .checkbox-row {
    display: flex;
    align-items: center;
    gap: 10px;
    height: 22px;
    cursor: pointer;
  }

  .checkbox-box {
    width: 22px;
    height: 22px;
    border-radius: 4px;
    border: 2px solid var(--Primary);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: background .15s, border-color .15s;
  }

  .checkbox-box.checked {
    background: var(--Primary);
    border-color: var(--Primary);
  }

  .checkbox-box svg {
    display: block;
    opacity: 0;
    transition: opacity .15s;
  }

  .checkbox-box.checked svg {
    opacity: 1;
  }

  .checkbox-label-row {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
  }

  .checkbox-label {
    font-size: 14px;
    font-weight: 700;
    line-height: 18px;
    color: var(--Primary);
  }

  .save-card-sub {
    padding-left: 32px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .save-card-sub-text {
    font-size: 11px;
    font-weight: 500;
    line-height: 14px;
    color: var(--Secondary);
  }

  .save-card-sub-bold {
    font-size: 11px;
    font-weight: 700;
    line-height: 14px;
    color: var(--Secondary);
  }

  .learn-more {
    font-size: 11px;
    font-weight: 700;
    line-height: 14px;
    color: var(--Primary);
    text-decoration: none;
    border-bottom: 1px solid var(--Primary);
    cursor: pointer;
  }

  .bottom-options-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    width: 100%;
  }

  .ssl-badge {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .ssl-badge span {
    font-size: 10px;
    font-weight: 500;
    line-height: 12px;
    color: var(--Tertiary);
  }

  /* CVV info icon */
  .cvv-info {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--Secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: help;
    position: relative;
  }

  .cvv-info span {
    font-size: 10px;
    font-weight: 700;
    color: white;
    line-height: 1;
  }

  /* ── Collapsed card item (non-selected) ── */
  .payment-item.card-collapsed {
    /* same as other items */
  }

  .card-brands-inline {
    display: inline-flex;
    padding: 4px 8px;
    background: white;
    border-radius: 4px;
    border: 0.5px solid var(--SurfaceStrong);
    align-items: center;
  }

  /* ── Bank logos ── */
  .bank-logos {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .bank-chip {
    width: 33px;
    height: 22px;
    border-radius: 4px;
    border: 0.5px solid var(--SurfaceStrong);
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .bank-more {
    font-size: 9px;
    font-weight: 500;
    line-height: 12px;
    color: var(--Secondary);
  }

  /* Cashback badge */
  .cashback-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: #EDFDF0;
    border-radius: 2px;
    border: 1px solid rgba(34, 226, 67, 0.5);
  }

  .cashback-badge span {
    font-size: 9px;
    font-weight: 700;
    line-height: 12px;
    color: #139028;
  }

  .app-only-chip {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: white;
    border-radius: 4px;
    border: 0.5px solid var(--SurfaceStrong);
  }

  .app-only-mobile { display: none; }
  .app-only-desktop { display: inline-flex; }
  .card-brands-mobile { display: none; }
  .bank-logos-mobile { display: none; }

  .app-only-chip span {
    font-size: 11px;
    font-weight: 500;
    line-height: 14px;
    color: var(--Secondary);
  }

  /* Show all footer */
  .show-all {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 4px;
    padding: 16px 32px;
    background: var(--SurfaceSuperLight);
    border-top: 1px solid var(--SurfaceLight);
    cursor: pointer;
    transition: background .15s;
  }

  .show-all:hover { background: var(--SurfaceLight); }

  /* Extra methods (collapsible) */
  .extra-methods {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.45s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .extra-methods-inner {
    overflow: hidden;
  }

  .extra-methods.open {
    grid-template-rows: 1fr;
  }

  .show-all span {
    font-size: 12px;
    font-weight: 700;
    line-height: 16px;
    color: var(--Primary);
  }

  /* Trust badges */
  .trust-row {
    display: flex;
    align-items: center;
    gap: 24px;
  }

  .trust-item {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .trust-item span {
    font-size: 10px;
    font-weight: 500;
    line-height: 12px;
    color: var(--Tertiary);
  }

  /* ── Right column ── */
  .right-col {
    width: 408px;
    display: flex;
    flex-direction: column;
    gap: 64px;
    position: sticky;
    top: 40px;
    align-self: flex-start;
  }

  .merchant-section {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .merchant-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }

  .merchant-left {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .merchant-logo {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background: var(--Background);
    border: 1px solid var(--SurfaceMedium);
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .merchant-logo img {
    width: 44px;
    height: 44px;
    border-radius: 16px;
    object-fit: cover;
  }

  .merchant-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .merchant-label {
    font-size: 10px;
    font-weight: 500;
    line-height: 12px;
    color: var(--Secondary);
    text-transform: uppercase;
  }

  .merchant-name {
    font-size: 16px;
    font-weight: 700;
    line-height: 20px;
    color: var(--Primary);
  }

  .lang-toggle {
    font-size: 14px;
    font-weight: 700;
    line-height: 16px;
    color: var(--Primary);
    cursor: pointer;
    border-bottom: 1px solid var(--Primary);
    padding-bottom: 1px;
  }

  /* Currency tabs */
  .currency-tabs {
    display: flex;
    flex-direction: column;
    gap: 8px;
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s ease;
  }

  .currency-tabs.visible {
    max-height: 80px;
    opacity: 1;
  }

  .currency-tabs-label {
    font-size: 10px;
    font-weight: 500;
    line-height: 12px;
    color: var(--Secondary);
  }

  .currency-tabs-row {
    display: flex;
    gap: 8px;
  }

  .currency-tab {
    height: 32px;
    padding: 0 16px;
    border-radius: 16px;
    border: 2px solid var(--SurfaceStrong);
    background: var(--Background);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: border-color 0.22s cubic-bezier(0.4,0,0.2,1),
                background 0.22s cubic-bezier(0.4,0,0.2,1),
                color 0.22s cubic-bezier(0.4,0,0.2,1),
                transform 0.15s ease;
    font-size: 12px;
    font-weight: 700;
    line-height: 16px;
    color: var(--Primary);
  }

  .currency-tab:hover:not(.active) {
    border-color: var(--Secondary);
    transform: translateY(-1px);
  }

  .currency-tab.active {
    border-color: var(--Primary);
    background: var(--Primary);
    color: white;
  }

  .total-box {
    padding: 20px;
    background: var(--SurfaceLight);
    border-radius: 8px;
    border: 1px solid var(--SurfaceMedium);
  }

  /* Default: stacked (label top, amount below) */
  .total-top-row {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  /* Converted: side-by-side */
  .total-box.converted .total-top-row {
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-end;
    gap: 0;
  }

  .total-label {
    font-size: 12px;
    font-weight: 700;
    line-height: 16px;
    color: var(--Secondary);
    text-transform: uppercase;
  }

  .total-amount {
    display: flex;
    align-items: flex-end;
    gap: 2px;
  }

  .total-amount .amount {
    font-size: 34px;
    font-weight: 700;
    line-height: 36px;
    color: var(--Primary);
    transition: opacity 0.18s ease, transform 0.18s ease;
  }

  .total-amount .amount.updating {
    opacity: 0;
    transform: translateY(-6px) scale(0.96);
  }

  .total-amount .currency {
    font-size: 14px;
    font-weight: 700;
    line-height: 18px;
    color: var(--Primary);
    padding-bottom: 2px;
    transition: opacity 0.18s ease, transform 0.18s ease;
  }

  .total-amount .currency.updating {
    opacity: 0;
    transform: translateY(-6px) scale(0.96);
  }

  .exchange-rate-row {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--SurfaceMedium);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .exchange-rate-text {
    font-size: 11px;
    font-weight: 500;
    color: var(--Secondary);
  }

  .exchange-rate-link {
    font-size: 11px;
    font-weight: 600;
    color: var(--Primary);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  /* Continue / Accept order section */
  .continue-section {
    display: flex;
    flex-direction: column;
    gap: 16px;
    align-items: center;
  }

  /* ── Static disabled button (before method selected) ── */
  .static-btn-row {
    display: flex;
    align-items: center;
    width: 100%;
  }

  .static-btn {
    flex: 1;
    height: 60px;
    border-radius: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Nunito', sans-serif;
    font-size: 17px;
    font-weight: 700;
    color: white;
    background: #B5B5B5;
    cursor: not-allowed;
  }

  .terms-text {
    font-size: 11px;
    font-weight: 500;
    line-height: 14px;
    color: var(--Primary);
    text-align: center;
  }

  .terms-text a {
    color: var(--Primary);
    font-weight: 700;
    text-decoration: underline;
  }

  /* ── Bottom bar / stepper ── */
  .bottom-bar {
    width: 100%;
    padding: 8px 16px;
    background: white;
    border-top: 1px solid var(--SurfaceLight);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    position: fixed;
    bottom: 0;
    left: 0;
    z-index: 100;
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .bottom-bar.visible {
    transform: translateY(0);
  }

  .step {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .step-circle {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 700;
    flex-shrink: 0;
  }

  .step-circle.active {
    border: 2px solid var(--Primary);
    color: var(--Primary);
  }

  .step-circle.inactive {
    border: 2px solid var(--SurfaceStrong);
    color: var(--SurfaceStrong);
  }

  .step-text {
    display: flex;
    flex-direction: column;
    gap: 1px;
  }

  .step-title { font-size: 10px; font-weight: 700; line-height: 12px; }
  .step-title.active { color: var(--Primary); }
  .step-title.inactive { color: var(--SurfaceStrong); }

  .step-sub { font-size: 9px; font-weight: 500; line-height: 12px; }
  .step-sub.active { color: var(--Secondary); }
  .step-sub.inactive { color: var(--SurfaceStrong); }

  .step-divider {
    width: 10px;
    height: 2px;
    background: var(--GraphSecondary);
    border-radius: 100px;
    flex-shrink: 0;
  }

  .pm-icon-overlay {
    position: absolute;
    bottom: -4px;
    right: -4px;
  }

  /* ── Expandable item (shared by BLIK, Card, etc.) ── */
  .expandable-item {
    background: var(--Background);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    padding: 24px;
    border: 3px solid transparent;
    border-radius: 0;
    gap: 0;
    transition: background 0.15s,
                border-color 0.35s cubic-bezier(0.4, 0, 0.2, 1),
                border-radius 0.35s cubic-bezier(0.4, 0, 0.2, 1),
                gap 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .expandable-item.expanded {
    border-radius: 20px;
    border-color: var(--Primary);
    background: #FFF;
    gap: 16px;
    cursor: default;
    padding-bottom: 24px;
  }

  .expandable-item:not(.expanded):hover {
    background: var(--SurfaceSuperLight);
  }

  .expandable-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
  }

  .expandable-content {
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    transition: grid-template-rows 0.45s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    width: 100%;
  }

  .expandable-content > .expandable-inner {
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .expandable-content.open {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  /* Redirect info text in expanded BLIK */
  .redirect-info {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 0;
  }

  .redirect-info svg {
    flex-shrink: 0;
    margin-top: 1px;
  }

  .redirect-info span {
    font-size: 13px;
    font-weight: 500;
    line-height: 18px;
    color: var(--Secondary);
  }

  /* ── Card panels (animated) ── */
  .card-panel {
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    transition: grid-template-rows 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    width: 100%;
  }

  .card-panel.active {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  .card-panel-inner {
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .text-link {
    font-size: 13px;
    font-weight: 700;
    color: var(--Primary);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .text-link-small {
    font-size: 12px;
    font-weight: 600;
    color: var(--Primary);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }

  .saved-card-row {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .saved-card-img {
    width: 100px;
    height: 64px;
    border-radius: 8px;
    overflow: hidden;
    flex-shrink: 0;
  }

  .saved-card-img svg {
    display: block;
    width: 100%;
    height: 100%;
  }

  .saved-card-number {
    font-size: 16px;
    font-weight: 600;
    color: var(--Primary);
    letter-spacing: 1px;
  }

  .saved-card-current {
    font-size: 14px;
    font-weight: 500;
    color: var(--Secondary);
  }

  .saved-card-status {
    font-size: 13px;
    font-weight: 500;
    color: var(--Secondary);
  }

  .saved-cards-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .enter-manual-btn {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-radius: 12px;
    border: 1px solid var(--SurfaceMedium);
    background: var(--Background);
    cursor: pointer;
    transition: background 0.15s;
    margin-top: 8px;
    margin-bottom: 4px;
  }

  .enter-manual-btn:hover {
    background: var(--SurfaceSuperLight);
  }

  .enter-manual-left {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .enter-manual-left span {
    font-size: 14px;
    font-weight: 700;
    color: var(--Primary);
  }

  .enter-manual-icon {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: var(--SurfaceSuperLight);
    border: 1px solid var(--SurfaceMedium);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .panel-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
  }

  .return-link {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 700;
    color: var(--Primary);
    text-decoration: none;
    transition: opacity 0.15s;
  }

  .return-link:hover {
    opacity: 0.7;
  }

  /* Small card brands chip (in C2P button) */
  .brands-chip-small {
    display: inline-flex;
    padding: 4px 8px;
    background: white;
    border-radius: 4px;
    border: 0.5px solid var(--SurfaceStrong);
    align-items: center;
    height: 22px;
  }

  /* ══════════════════════════════════════════
     TABLET RESPONSIVE (769px - 1100px)
     ══════════════════════════════════════════ */
  @media (max-width: 1100px) and (min-width: 769px) {
    .page {
      width: 100%;
      padding: 40px 24px 160px;
    }

    .content {
      gap: 24px;
    }

    .left-col {
      flex: 1;
      min-width: 0;
    }

    .right-col {
      width: 320px;
      flex-shrink: 0;
    }

    .right-col-inner {
      width: 320px;
    }

    .total-box { padding: 20px; }
    .total-amount .amount { font-size: 36px; }
  }

  /* ══════════════════════════════════════════
     MOBILE RESPONSIVE (≤768px)
     ══════════════════════════════════════════ */
  @media (max-width: 768px) {
    .page {
      width: 100%;
      padding: 0;
      gap: 0;
    }

    .content {
      flex-direction: column;
      gap: 0;
      width: 100%;
      padding-bottom: 240px;
    }

    /* ── Left col ── */
    .left-col {
      width: 100%;
      gap: 16px;
      padding: 0 20px;
      align-items: stretch;
    }

    /* Hide desktop header */
    .header-row { display: none; }

    /* Mobile header: merchant + EN */
    .mobile-header {
      display: flex !important;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      width: 100%;
      background: #FFFFFF;
    }

    .mobile-header .merchant-logo {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      flex-shrink: 0;
    }

    .mobile-header .mobile-header-left {
      display: flex !important;
      flex-direction: row !important;
      align-items: center;
      gap: 10px;
    }

    .mobile-header .merchant-logo img {
      width: 44px;
      height: 44px;
      border-radius: 12px;
    }

    .mobile-header .merchant-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .mobile-header .merchant-label {
      font-size: 10px;
      color: var(--Secondary);
    }

    .mobile-header .merchant-name {
      font-size: 16px;
      font-weight: 700;
    }

    .mobile-header .lang-toggle {
      font-size: 14px;
      font-weight: 700;
    }

    /* Mobile title: "Payment method for Poland ˅" */
    .mobile-title {
      display: block !important;
      font-size: 20px;
      font-weight: 700;
      padding: 20px 0 12px;
      line-height: 1.3;
      text-align: left;
    }

    .mobile-title .underlined-country {
      text-decoration: underline;
      text-decoration-color: var(--Primary);
      text-underline-offset: 4px;
      text-decoration-thickness: 1px;
    }

    /* Payment card */
    .payment-card {
      border-radius: 16px;
    }

    .payment-card > *:first-child { border-radius: 16px 16px 0 0; }
    .payment-card > *:last-child { border-radius: 0 0 16px 16px; }

    .payment-item { padding: 16px; flex-wrap: wrap; }
    .expandable-item { padding: 16px; }
    .expandable-item.expanded { border-radius: 16px; padding-bottom: 16px; }

    /* On mobile, payment-item-left takes full width so brands/chips go below */
    .payment-item .payment-item-left {
      width: 100%;
      align-items: center;
    }
    /* Hide desktop-positioned bank logos on mobile */
    .payment-item > .bank-logos {
      display: none !important;
    }
    /* Show mobile bank logos inside pm-info */
    .bank-logos-mobile {
      display: flex !important;
      align-items: center;
      gap: 6px;
      margin-top: 4px;
      width: fit-content;
    }

    /* Also for expandable items (Card) - brands below text */
    .expandable-header {
      flex-wrap: wrap;
      align-items: center;
    }
    .expandable-header .payment-item-left {
      width: 100%;
      align-items: center;
    }
    /* Hide the sibling brands-inline on mobile; we show the one inside pm-info instead */
    .expandable-header > .card-brands-inline {
      display: none !important;
    }
    .card-brands-mobile {
      display: inline-flex !important;
      align-items: center;
      margin-top: 4px;
      width: fit-content;
      padding: 4px 8px;
      border: 0.5px solid var(--SurfaceStrong);
      border-radius: 4px;
      background: white;
    }

    .pm-icon { width: 48px; height: 48px; border-radius: 12px; }
    .pm-name { font-size: 16px; }
    .pm-desc { font-size: 13px; }

    .app-only-mobile { display: inline-flex !important; margin-top: 4px; padding: 3px 6px; width: auto; align-self: flex-start; }
    .app-only-mobile span { font-size: 10px; line-height: 14px; }
    .app-only-mobile svg { width: 10px; height: 10px; }
    .app-only-desktop { display: none !important; }

    /* Prevent card brands from stretching in flex column */

    .show-all { padding: 14px 16px; font-size: 13px; }

    .trust-row {
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px 16px;
      padding: 20px 0;
    }

    /* ── Right col → fixed mobile bottom bar ── */
    .right-col {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      width: 100% !important;
      z-index: 200;
      background: white;
      border-top: 1px solid var(--SurfaceMedium);
      box-shadow: 0 -2px 16px rgba(0,0,0,0.08);
      padding: 16px 20px calc(max(12px, env(safe-area-inset-bottom)));
      gap: 10px;
      top: auto;
      align-self: auto;
    }

    .merchant-section { gap: 10px; }
    .merchant-header { display: none; }

    /* Desktop currency tabs hidden on mobile */
    .currency-tabs { display: none !important; }

    /* Mobile total box — no background/border */
    .total-box {
      padding: 0;
      background: transparent;
      border: none;
      border-radius: 0;
    }

    .total-label { display: none; } /* hide "TOTAL TO PAY" label on mobile */

    .total-top-row {
      flex-direction: row !important;
      align-items: flex-end;
      gap: 4px;
    }

    .total-amount .amount {
      font-size: 32px;
      line-height: 36px;
      font-weight: 700;
    }

    .total-amount .currency {
      font-size: 14px;
      padding-bottom: 3px;
    }

    /* Mobile currency dropdown hint (shown after method selected via JS) */
    .mobile-currency-chevron {
      display: none !important;
      margin-left: 2px;
      align-self: flex-end;
      padding-bottom: 5px;
    }

    .mobile-currency-chevron.visible {
      display: flex !important;
    }

    /* Underline on currency when method selected */
    .total-amount.has-dropdown .currency {
      text-decoration: underline;
      text-underline-offset: 3px;
      text-decoration-thickness: 1px;
      cursor: pointer;
    }

    .exchange-rate-row {
      margin-top: 2px;
      padding-top: 0;
      border-top: none;
      font-size: 11px;
    }

    /* Continue section */
    .continue-section {
      gap: 8px;
      width: 100%;
    }

    .static-btn-row { width: 100%; }
    .static-btn {
      height: 60px;
      font-size: 16px;
      border-radius: 100px;
    }

    /* Canvas stepper fills mobile width */
    #stepperWrap {
      width: 100% !important;
      height: 60px !important;
    }

    #stepperCanvas {
      width: 100% !important;
      height: 60px !important;
    }

    .terms-text {
      font-size: 11px;
      text-align: center;
      line-height: 1.4;
      min-height: 32px;
    }

    /* ── Mobile: Card detail view ── */
    body.mobile-card-view .mobile-header,
    body.mobile-card-view .mobile-title,
    body.mobile-card-view .trust-row,
    body.mobile-card-view #blikItem,
    body.mobile-card-view #sep-blik-card,
    body.mobile-card-view #sep-card-apple,
    body.mobile-card-view #showAllBtn,
    body.mobile-card-view .extra-methods {
      display: none !important;
    }

    /* Hide all non-expandable items in card view */
    body.mobile-card-view .payment-card > .payment-item,
    body.mobile-card-view .payment-card > .payment-separator {
      display: none !important;
    }

    body.mobile-card-view .payment-card {
      border: none;
      box-shadow: none;
    }

    body.mobile-card-view .left-col {
      padding-top: 0;
    }

    /* Hide "Return to saved cards" only in saved panel on mobile — back arrow replaces it */
    body.mobile-card-view #panelSaved .return-link {
      display: none;
    }

    /* Hide card expandable-item header on mobile (replaced by mobile-card-header) */
    body.mobile-card-view #cardItem .expandable-header {
      display: none !important;
    }

    /* Card expanded content in mobile view */
    body.mobile-card-view #cardItem.expanded {
      border: none;
      box-shadow: none;
      padding: 0;
    }

    /* Keep card-panel-inner border visible */
    body.mobile-card-view .card-panel-inner {
      border: 2px solid var(--Primary);
      border-radius: 16px;
      padding: 20px;
    }

    body.mobile-card-view #panelSaved .panel-footer {
      justify-content: center;
    }
    body.mobile-card-view .expandable-item.expanded {
      padding-bottom: 20px;
    }

    .mobile-card-header {
      display: none;
      align-items: center;
      gap: 12px;
      padding: 16px 20px;
      width: 100%;
      background: #FFFFFF;
    }

    body.mobile-card-view .mobile-card-header {
      display: flex !important;
    }

    .mobile-back-arrow {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
    }

    .mobile-card-header .pm-icon {
      width: 44px;
      height: 44px;
    }

    .mobile-card-header .pm-info .pm-name {
      font-size: 18px;
      font-weight: 700;
    }

    .mobile-card-header .pm-info .pm-desc {
      font-size: 13px;
      color: var(--Secondary);
    }

    /* Panel footer layout on mobile card view */

    .save-card-sub {
      flex-wrap: wrap;
      gap: 4px 6px;
    }

    .save-card-section {
      gap: 6px;
    }

    /* Desktop bottom bar hidden on mobile */
    .bottom-bar {
      display: none !important;
    }

    /* Mobile steps info line */
    .mobile-steps {
      display: none;
      justify-content: center;
      align-items: center;
      gap: 4px;
      font-size: 10px;
      color: var(--Secondary);
    }

    .mobile-steps.visible {
      display: flex !important;
    }

    .mobile-steps a {
      color: var(--Primary);
      font-weight: 700;
      text-decoration: underline;
      text-underline-offset: 2px;
    }
  }

  /* Elements hidden on desktop, shown on mobile */
  .mobile-header { display: none; }
  .mobile-title { display: none; }
  .mobile-steps { display: none; }
  .mobile-currency-chevron { display: none; }
  .mobile-card-header { display: none; }
  .mobile-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
  }
</style>
</head>
<body>

<!-- ── Sticky top bar ── -->
<div id="topBar" style="
  position:fixed;top:0;left:0;right:0;z-index:999;
  background:rgba(255,255,255,0.92);
  backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
  border-bottom:1px solid #EBEBEB;
  padding:7px 20px;
  display:flex;align-items:center;justify-content:space-between;
  font-family:'Nunito',sans-serif;
">
  <span style="font-size:10px;font-weight:700;color:#A3A3A3;letter-spacing:0.3px;">ZEN.COM Pay 2.0 Checkout</span>
  <div style="position:relative;">
    <button id="authorBtn" onclick="toggleAuthorCard()" style="
      background:none;border:none;cursor:pointer;padding:0;
      font-family:'Nunito',sans-serif;font-size:10px;font-weight:600;color:#A3A3A3;
      letter-spacing:0.3px;text-decoration:underline;text-underline-offset:2px;
      transition:color 0.15s;
    " onmouseenter="this.style.color='#222'" onmouseleave="this.style.color='#A3A3A3'">Designed and Built by Mateusz Karbowski</button>
    <div id="authorCard" style="
      position:absolute;right:0;top:calc(100% + 8px);
      background:#fff;border:1px solid #EBEBEB;border-radius:16px;
      box-shadow:0 8px 32px rgba(0,0,0,0.10);
      padding:16px 18px;width:240px;
      display:flex;flex-direction:column;align-items:center;gap:10px;
      opacity:0;transform:translateY(-8px) scale(0.97);pointer-events:none;
      transition:opacity 0.22s cubic-bezier(0.4,0,0.2,1),transform 0.22s cubic-bezier(0.4,0,0.2,1);
    ">
      <img src="./mateusz-karbowski.jpg" alt="Mateusz Karbowski" style="
        width:56px;height:56px;border-radius:50%;object-fit:cover;
        border:2px solid #EBEBEB;
      ">
      <p style="font-size:11px;font-weight:500;color:#727272;text-align:center;line-height:16px;margin:0;">
        If you have any questions or suggestions, feel free to reach out at<br>
        <a href="mailto:mateusz.karbowski@zen.com" style="color:#222;font-weight:700;text-decoration:underline;text-underline-offset:2px;">mateusz.karbowski@zen.com</a>
      </p>
    </div>
  </div>
</div>
<script>
function toggleAuthorCard(){
  const c=document.getElementById('authorCard');
  const isOpen=c.style.opacity==='1';
  if(isOpen){
    c.style.opacity='0';c.style.transform='translateY(-8px) scale(0.97)';c.style.pointerEvents='none';
  } else {
    c.style.opacity='1';c.style.transform='translateY(0) scale(1)';c.style.pointerEvents='auto';
  }
}
document.addEventListener('click',function(e){
  if(!document.getElementById('authorBtn').contains(e.target)&&!document.getElementById('authorCard').contains(e.target)){
    const c=document.getElementById('authorCard');
    c.style.opacity='0';c.style.transform='translateY(-8px) scale(0.97)';c.style.pointerEvents='none';
  }
});
</script>

<div class="mobile-card-header" id="mobileCardHeader">
  <div class="mobile-back-arrow" onclick="mobileBackToList()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M15 18l-6-6 6-6" stroke="#222" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
  </div>
  <div class="pm-icon" style="width:44px;height:44px;border-radius:10px;">
    <svg width="20" height="14" viewBox="0 0 20 14" fill="none"><rect x="1" y="1" width="18" height="12" rx="2" stroke="#222" stroke-width="1.4" fill="none"/><path d="M1 5h18" stroke="#222" stroke-width="1.4"/></svg>
  </div>
  <div class="pm-info" style="flex:1;">
    <div class="pm-name">Card</div>
    <div class="pm-desc">Debit or credit</div>
  </div>
  <div class="brands-row" style="gap:2px;">
    <svg width="90" height="24" viewBox="0 0 90 24" fill="none">
      <rect x="0" y="0" width="90" height="24" rx="4" fill="white" stroke="#EBEBEB" stroke-width="0.5"/>
      <path d="M12 16c.8-.8 1.2-1.8 1.2-2.8S12.8 11.4 12 10.6" stroke="#222" stroke-width="1" fill="none" stroke-linecap="round"/>
      <path d="M14.5 17.5c1.5-1.5 2.3-3.3 2.3-5.3s-.8-3.8-2.3-5.3" stroke="#222" stroke-width="1" fill="none" stroke-linecap="round"/>
      <path d="M9.5 14.8c.5-.5.8-1.2.8-2s-.3-1.5-.8-2" stroke="#222" stroke-width="1" fill="none" stroke-linecap="round"/>
      <rect x="22" y="4" width="1" height="16" fill="#DFDFDF"/>
      <circle cx="36" cy="12" r="7" fill="#EB001B"/>
      <circle cx="46" cy="12" r="7" fill="#F79E1B"/>
      <path d="M41 6a7 7 0 010 12 7 7 0 000-12z" fill="#FF5F00"/>
      <path d="M59 7l4.8 10h-2l-.9-2h-4l-.9 2h-2L59 7z" fill="#1A1F71"/>
      <path d="M58.3 13.5h2.4L59.5 10l-1.2 3.5z" fill="white"/>
      <rect x="66" y="7" width="3" height="10" fill="#1A1F71"/>
      <rect x="66" y="7" width="12" height="3" fill="#1A1F71"/>
      <rect x="75" y="7" width="3" height="10" fill="#1A1F71"/>
      <path d="M72 12c0-1.7 1.3-3 3-3h3v6h-3c-1.7 0-3-1.3-3-3z" fill="#1A1F71"/>
      <text x="82" y="15" font-family="Arial" font-weight="bold" font-size="7" fill="#1A1F71">A</text>
    </svg>
  </div>
</div>

<div class="mobile-header">
  <div class="mobile-header-left">
    <div class="merchant-logo">
      <img src="./icons/super-merchant-logo.svg" alt="merchant" style="display:block;width:44px;height:44px;border-radius:12px;">
    </div>
    <div class="merchant-info">
      <div class="merchant-label">Payment for:</div>
      <div class="merchant-name">super-merchant.com</div>
    </div>
  </div>
  <div class="lang-toggle">EN</div>
</div>

<div class="page">
  <div class="content">

    <!-- ════════ LEFT COLUMN ════════ -->
    <div class="left-col">

      <div class="mobile-title">Payment method for <span class="underlined-country">Poland</span><svg width="14" height="14" viewBox="0 0 14 14" fill="none" style="margin-left:4px;vertical-align:middle"><path d="M4 5.5L7 8.5L10 5.5" stroke="#222" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>

      <div class="header-row">
        <div>
          <div class="header-title">Select payment method</div>
          <div class="header-subtitle">12 methods available</div>
        </div>
        <div class="country-selector">
          <div class="country-label">Country</div>
          <div class="country-value-row">
            <span class="country-value">Poland</span>
            <div class="country-chevron">
              <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M3 4.5L6 7.5L9 4.5" stroke="#222" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
          </div>
          <div class="country-underline"></div>
        </div>
      </div>

      <div class="payment-card">

        <!-- BLIK (expandable) -->
        <div class="expandable-item" id="blikItem" onclick="expandItem('blik')">
          <div class="expandable-header">
            <div class="payment-item-left">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
                <img src="./icons/Blik3.svg" alt="BLIK" style="width:40px;height:40px;border-radius:12px;display:block;">
              </div>
              <div class="pm-info">
                <div class="pm-name">BLIK</div>
                <div class="pm-desc">Use code from you bank app</div>
              </div>
            </div>
          </div>
          <div class="expandable-content" id="blikExpanded">
            <div class="expandable-inner">
              <div class="redirect-info">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <rect x="1" y="3" width="10" height="12" rx="1.5" stroke="#727272" stroke-width="1.4" fill="none"/>
                  <path d="M5 3V2.5A1.5 1.5 0 016.5 1h3A1.5 1.5 0 0111 2.5V3" stroke="#727272" stroke-width="1.4" fill="none"/>
                  <path d="M13 5l2 2-2 2" stroke="#727272" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M8 7h7" stroke="#727272" stroke-width="1.4" stroke-linecap="round"/>
                </svg>
                <span>After clicking Pay, you'll be redirected to the next step to securely provide your payment details.</span>
              </div>
            </div>
          </div>
        </div>
        <hr class="payment-separator" id="sep-blik-card">

        <!-- CARD (expandable) -->
        <div class="expandable-item" id="cardItem" onclick="expandItem('card')">
          <div class="expandable-header">
            <div class="payment-item-left" id="cardHeader">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
                <img src="./icons/card.svg" alt="Card" style="width:40px;height:40px;border-radius:12px;display:block;">
              </div>
              <div class="pm-info">
                <div class="pm-name">Card</div>
                <div class="pm-desc">Debit or credit</div>
                <div class="card-brands-mobile">
                  <svg width="84" height="14" viewBox="0 0 84 14" fill="none">
                    <path d="M7 9.5c1-1 1.5-2.2 1.5-3.5S8 3.5 7 2.5" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round"/>
                    <path d="M10 11c1.8-1.8 2.8-4 2.8-6.5S11.8 0 10 0" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round" transform="translate(0,1)"/>
                    <path d="M4 8c.6-.6 1-1.5 1-2.5S4.6 3.6 4 3" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round"/>
                    <rect x="22" y="1" width="1" height="12" fill="#222"/>
                    <circle cx="35" cy="7" r="6" fill="#EB001B"/>
                    <circle cx="43" cy="7" r="6" fill="#F79E1B"/>
                    <path d="M39 2.3a6 6 0 010 9.4 6 6 0 000-9.4z" fill="#FF5F00"/>
                    <g transform="translate(54, 2)"><path d="M7.2 0L4.5 10h-2.3L4.9 0H7.2zM14.5 6.5l1.2-3.3.7 3.3H14.5zM17.2 10h2.1L17.5 0h-1.9c-.4 0-.8.3-1 .7L11 10h2.3l.5-1.3h2.8l.3 1.3h.3zM12 3.4L12.5 0H10.3L8 10h2.2L12 3.4zM5 0L2.2 10H0L2.8 0H5z" fill="#1A1F71"/></g>
                  </svg>
                </div>
              </div>
            </div>
            <div id="cardBrandsCollapsed" class="card-brands-inline">
              <svg width="84" height="14" viewBox="0 0 84 14" fill="none">
                <path d="M7 9.5c1-1 1.5-2.2 1.5-3.5S8 3.5 7 2.5" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round"/>
                <path d="M10 11c1.8-1.8 2.8-4 2.8-6.5S11.8 0 10 0" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round" transform="translate(0,1)"/>
                <path d="M4 8c.6-.6 1-1.5 1-2.5S4.6 3.6 4 3" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round"/>
                <rect x="22" y="1" width="1" height="12" fill="#222"/>
                <circle cx="35" cy="7" r="6" fill="#EB001B"/>
                <circle cx="43" cy="7" r="6" fill="#F79E1B"/>
                <path d="M39 2.3a6 6 0 010 9.4 6 6 0 000-9.4z" fill="#FF5F00"/>
                <g transform="translate(54, 2)"><path d="M7.2 0L4.5 10h-2.3L4.9 0H7.2zM14.5 6.5l1.2-3.3.7 3.3H14.5zM17.2 10h2.1L17.5 0h-1.9c-.4 0-.8.3-1 .7L11 10h2.3l.5-1.3h2.8l.3 1.3h.3zM12 3.4L12.5 0H10.3L8 10h2.2L12 3.4zM5 0L2.2 10H0L2.8 0H5z" fill="#1A1F71"/></g>
              </svg>
            </div>
          </div>

          <!-- Expanded content -->
          <div class="expandable-content" id="cardExpanded">
           <div class="expandable-inner" onclick="event.stopPropagation()">

            <!-- PANEL 1: Saved card (default) -->
            <div class="card-panel active" id="panelSaved">
             <div class="card-panel-inner">
              <a class="text-link" href="javascript:void(0)" onclick="event.preventDefault()">Not your card?</a>
              <div class="saved-card-row">
                <div class="saved-card-img"><svg width="100" height="64" viewBox="0 0 100 64" fill="none"><rect width="100" height="64" rx="8" fill="#1a1a2e"/><text x="10" y="20" font-family="Nunito" font-size="9" font-weight="700" fill="#4ade80">zen</text><rect x="10" y="42" width="30" height="4" rx="2" fill="#333"/><rect x="10" y="50" width="20" height="4" rx="2" fill="#333"/><circle cx="85" cy="52" r="8" fill="#2563eb" opacity="0.6"/><circle cx="78" cy="52" r="8" fill="#06b6d4" opacity="0.6"/></svg></div>
                <span class="saved-card-number" id="activeCardNumber">**** 5555</span>
                <a class="text-link" href="javascript:void(0)" onclick="event.preventDefault(); showCardPanel('list')">Change</a>
              </div>
              <div class="panel-footer">
                <div></div>
                <div class="ssl-badge">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L2 3v3c0 2.7 1.7 5.2 4 6 2.3-.8 4-3.3 4-6V3L6 1z" stroke="#A3A3A3" stroke-width="1.2" fill="none"/></svg>
                  <span>SSL Secure</span>
                </div>
              </div>
             </div>
            </div>

            <!-- PANEL 2: All saved cards -->
            <div class="card-panel" id="panelList">
             <div class="card-panel-inner">
              <a class="text-link" href="javascript:void(0)" onclick="event.preventDefault()">Not your cards?</a>
              <div class="saved-cards-list">
                <div class="saved-card-row">
                  <div class="saved-card-img"><svg width="100" height="64" viewBox="0 0 100 64" fill="none"><rect width="100" height="64" rx="8" fill="#1a1a2e"/><text x="10" y="20" font-family="Nunito" font-size="9" font-weight="700" fill="#4ade80">zen</text><rect x="10" y="42" width="30" height="4" rx="2" fill="#333"/><rect x="10" y="50" width="20" height="4" rx="2" fill="#333"/><circle cx="85" cy="52" r="8" fill="#2563eb" opacity="0.6"/><circle cx="78" cy="52" r="8" fill="#06b6d4" opacity="0.6"/></svg></div>
                  <span class="saved-card-number">**** 5555</span>
                  <span class="saved-card-current">Current</span>
                </div>
                <div class="saved-card-row">
                  <div class="saved-card-img"><svg width="100" height="64" viewBox="0 0 100 64" fill="none"><rect width="100" height="64" rx="8" fill="#1a1a2e"/><text x="10" y="20" font-family="Nunito" font-size="9" font-weight="700" fill="#4ade80">zen</text><rect x="10" y="42" width="30" height="4" rx="2" fill="#333"/><rect x="10" y="50" width="20" height="4" rx="2" fill="#333"/><circle cx="85" cy="52" r="8" fill="#2563eb" opacity="0.6"/><circle cx="78" cy="52" r="8" fill="#06b6d4" opacity="0.6"/></svg></div>
                  <span class="saved-card-number">**** 2323</span>
                  <a class="text-link" href="javascript:void(0)" onclick="event.preventDefault(); chooseCard('2323')">Choose</a>
                </div>
                <div class="saved-card-row">
                  <div class="saved-card-img"><svg width="100" height="64" viewBox="0 0 100 64" fill="none"><rect width="100" height="64" rx="8" fill="#1a1a2e"/><text x="10" y="20" font-family="Nunito" font-size="9" font-weight="700" fill="#4ade80">zen</text><rect x="10" y="42" width="30" height="4" rx="2" fill="#333"/><rect x="10" y="50" width="20" height="4" rx="2" fill="#333"/><circle cx="85" cy="52" r="8" fill="#2563eb" opacity="0.6"/><circle cx="78" cy="52" r="8" fill="#06b6d4" opacity="0.6"/></svg></div>
                  <span class="saved-card-number">**** 4235</span>
                  <a class="text-link" href="javascript:void(0)" onclick="event.preventDefault(); chooseCard('4235')">Choose</a>
                </div>
              </div>
              <a class="text-link-small" href="javascript:void(0)" onclick="event.preventDefault()">View all saved cards <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M3 2l3 3-3 3" stroke="#222" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
              <div class="enter-manual-btn" onclick="showCardPanel('manual')">
                <div class="enter-manual-left">
                  <div class="enter-manual-icon">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 3v10M3 8h10" stroke="#222" stroke-width="2" stroke-linecap="round"/></svg>
                  </div>
                  <span>Enter card manually</span>
                </div>
                <svg width="8" height="14" viewBox="0 0 8 14" fill="none"><path d="M1 1l6 6-6 6" stroke="#222" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </div>
              <div class="panel-footer">
                <a class="return-link" href="javascript:void(0)" onclick="event.preventDefault(); showCardPanel('saved')">
                  <svg width="8" height="14" viewBox="0 0 8 14" fill="none"><path d="M7 1L1 7l6 6" stroke="#222" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  <span>Return</span>
                </a>
                <div class="ssl-badge">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L2 3v3c0 2.7 1.7 5.2 4 6 2.3-.8 4-3.3 4-6V3L6 1z" stroke="#A3A3A3" stroke-width="1.2" fill="none"/></svg>
                  <span>SSL Secure</span>
                </div>
              </div>
             </div>
            </div>

            <!-- PANEL 3: Manual card entry -->
            <div class="card-panel" id="panelManual">
             <div class="card-panel-inner">
              <div class="card-form">
                <div class="fields-group">
                  <div class="field">
                    <label class="field-label">Card number</label>
                    <div class="field-input-wrap">
                      <div class="field-input-row">
                        <div class="field-icon">
                          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="1.5" y="4" width="17" height="12" rx="2" stroke="#727272" stroke-width="1.8" fill="none"/>
                            <rect x="1.5" y="7" width="17" height="3" fill="#727272"/>
                          </svg>
                        </div>
                        <input type="text" id="cardNumber" placeholder="0000 0000 0000 0000" maxlength="19" inputmode="numeric" autocomplete="cc-number">
                      </div>
                      <div class="field-underline"></div>
                    </div>
                  </div>
                  <div class="field-row">
                    <div class="field">
                      <label class="field-label">Expiry date</label>
                      <div class="field-input-wrap">
                        <div class="field-input-row">
                          <input type="text" id="expiryDate" placeholder="MM / YY" maxlength="7" inputmode="numeric" autocomplete="cc-exp">
                        </div>
                        <div class="field-underline"></div>
                      </div>
                    </div>
                    <div class="field">
                      <label class="field-label">CVC / CVV</label>
                      <div class="field-input-wrap">
                        <div class="field-input-row">
                          <input type="text" id="cvv" placeholder="CVV" maxlength="4" inputmode="numeric" autocomplete="cc-csc">
                          <div class="field-action">
                            <div class="cvv-info" title="3 or 4 digit code on your card"><span>?</span></div>
                          </div>
                        </div>
                        <div class="field-underline"></div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="save-card-section">
                  <div class="checkbox-row" onclick="toggleCheckbox('saveCard')">
                    <div class="checkbox-box checked" id="saveCardBox">
                      <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7l3 3 5-5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <div class="checkbox-label-row">
                      <span class="checkbox-label">Save your card</span>
                      <div class="brands-chip-small">
                        <svg width="51" height="14" viewBox="0 0 51 14" fill="none">
                          <path d="M7 9.5c1-1 1.5-2.2 1.5-3.5S8 3.5 7 2.5" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round"/>
                          <path d="M10 11c1.8-1.8 2.8-4 2.8-6.5S11.8 0 10 0" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round" transform="translate(0,1)"/>
                          <path d="M4 8c.6-.6 1-1.5 1-2.5S4.6 3.6 4 3" stroke="#222" stroke-width="1.2" fill="none" stroke-linecap="round"/>
                          <rect x="22" y="1" width="1" height="12" fill="#222"/>
                          <circle cx="35" cy="7" r="6" fill="#EB001B"/>
                          <circle cx="43" cy="7" r="6" fill="#F79E1B"/>
                          <path d="M39 2.3a6 6 0 010 9.4 6 6 0 000-9.4z" fill="#FF5F00"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                  <div class="save-card-sub">
                    <span class="save-card-sub-text">Your data will be stored securely in</span>
                    <span class="save-card-sub-bold">Mastercard</span>
                    <a class="learn-more" href="javascript:void(0)" onclick="event.stopPropagation()">Learn more</a>
                  </div>
                </div>
              </div>
              <div class="panel-footer">
                <a class="return-link" href="javascript:void(0)" onclick="event.preventDefault(); showCardPanel('list')">
                  <svg width="8" height="14" viewBox="0 0 8 14" fill="none"><path d="M7 1L1 7l6 6" stroke="#222" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  <span>Return to saved cards</span>
                </a>
                <div class="ssl-badge">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L2 3v3c0 2.7 1.7 5.2 4 6 2.3-.8 4-3.3 4-6V3L6 1z" stroke="#A3A3A3" stroke-width="1.2" fill="none"/></svg>
                  <span>SSL Secure</span>
                </div>
              </div>
             </div>
            </div>
           </div>
          </div>
        </div>
        <hr class="payment-separator" id="sep-card-apple">

        <!-- Apple Pay -->
        <div class="payment-item" onclick="collapseAll()">
          <div class="payment-item-left">
            <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
              <img src="./icons/Applepay.svg" alt="Apple Pay" style="width:40px;height:40px;border-radius:12px;display:block;">
            </div>
            <div class="pm-info">
              <div class="pm-name">Apple Pay</div>
              <div class="pm-desc">Pay with Apple Pay</div>
            </div>
          </div>
        </div>
        <hr class="payment-separator">

        <!-- Google Pay -->
        <div class="payment-item" onclick="collapseAll()">
          <div class="payment-item-left">
            <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
              <img src="./icons/GPay.svg" alt="Google Pay" style="width:40px;height:40px;border-radius:12px;display:block;">
            </div>
            <div class="pm-info">
              <div class="pm-name">Google Pay</div>
              <div class="pm-desc">Pay with Google Pay</div>
            </div>
          </div>
        </div>
        <hr class="payment-separator">

        <!-- Instant Bank Transfer -->
        <div class="payment-item" onclick="collapseAll()">
          <div class="payment-item-left">
            <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
              <img src="./icons/BankTransfer2.svg" alt="Bank Transfer" style="width:40px;height:40px;border-radius:12px;display:block;">
            </div>
            <div class="pm-info">
              <div class="pm-name">Instant Bank Transfer</div>
              <div class="pm-desc">Choose your bank</div>
              <div class="bank-logos-mobile">
                <div class="bank-chip"><img src="./icons/Bank-Pekao.svg" alt="Pekao" style="height:20px;width:auto;border-radius:4px;"></div>
                <div class="bank-chip"><img src="./icons/Bank-Ing.svg" alt="ING" style="height:20px;width:auto;border-radius:4px;"></div>
                <div class="bank-chip"><img src="./icons/Bank-Mbank.svg" alt="mBank" style="height:20px;width:auto;border-radius:4px;"></div>
                <span class="bank-more">15+ more</span>
              </div>
            </div>
          </div>
          <div class="bank-logos">
            <div class="bank-chip"><img src="./icons/Bank-Pekao.svg" alt="Pekao" style="height:20px;width:auto;border-radius:4px;"></div>
            <div class="bank-chip"><img src="./icons/Bank-Ing.svg" alt="ING" style="height:20px;width:auto;border-radius:4px;"></div>
            <div class="bank-chip"><img src="./icons/Bank-Mbank.svg" alt="mBank" style="height:20px;width:auto;border-radius:4px;"></div>
            <span class="bank-more">15+ more</span>
          </div>
        </div>
        <hr class="payment-separator">

        <!-- ZEN.COM App -->
        <div class="payment-item zen-app-item" onclick="collapseAll()">
          <div class="payment-item-left">
            <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
              <img src="./icons/zencomapp.svg" alt="ZEN.COM App" style="width:40px;height:40px;border-radius:12px;display:block;">
            </div>
            <div class="pm-info">
              <div class="pm-name-row">
                <span class="pm-name">ZEN.COM App</span>
                <div class="cashback-badge">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L7.5 4.5L11 5.5L8.5 8L9 11.5L6 10L3 11.5L3.5 8L1 5.5L4.5 4.5L6 1z" stroke="#139028" stroke-width="1.2" fill="none" stroke-linejoin="round"/></svg>
                  <span>CASHBACK 2 EUR</span>
                </div>
              </div>
              <div class="pm-desc">One-Scan Payment</div>
              <div class="app-only-chip app-only-mobile">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><rect x="3" y="1" width="6" height="10" rx="1" stroke="#727272" stroke-width="1.2" fill="none"/><line x1="4.5" y1="9" x2="7.5" y2="9" stroke="#727272" stroke-width="0.8" stroke-linecap="round"/></svg>
                <span>App users only</span>
              </div>
            </div>
          </div>
          <div class="app-only-chip app-only-desktop">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><rect x="3" y="1" width="6" height="10" rx="1" stroke="#727272" stroke-width="1.2" fill="none"/><line x1="4.5" y1="9" x2="7.5" y2="9" stroke="#727272" stroke-width="0.8" stroke-linecap="round"/></svg>
            <span>App users only</span>
          </div>
        </div>
        <hr class="payment-separator">

        <!-- ZEN.COM CashCard -->
        <div class="payment-item" onclick="collapseAll()">
          <div class="payment-item-left">
            <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;">
              <img src="./icons/zencomcashcard.svg" alt="ZEN.COM CashCard" style="width:40px;height:40px;border-radius:12px;display:block;">
            </div>
            <div class="pm-info">
              <div class="pm-name">ZEN.COM CashCard</div>
              <div class="pm-desc">Pay with prepaid card</div>
            </div>
          </div>
        </div>

        <!-- Extra methods (hidden by default) -->
        <div class="extra-methods" id="extraMethods">
          <div class="extra-methods-inner">
          <hr class="payment-separator">
          <div class="payment-item" onclick="collapseAll()">
            <div class="payment-item-left">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;"><img src="./icons/Ideal.svg" alt="iDeal" style="width:40px;height:40px;border-radius:12px;display:block;"></div>
              <div class="pm-info"><div class="pm-name">iDeal</div></div>
            </div>
          </div>
          <hr class="payment-separator">
          <div class="payment-item" onclick="collapseAll()">
            <div class="payment-item-left">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;"><img src="./icons/Skrill.svg" alt="Skrill" style="width:40px;height:40px;border-radius:12px;display:block;"></div>
              <div class="pm-info"><div class="pm-name">SKRILL</div></div>
            </div>
          </div>
          <hr class="payment-separator">
          <div class="payment-item" onclick="collapseAll()">
            <div class="payment-item-left">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;"><img src="./icons/Netteler.svg" alt="Neteller" style="width:40px;height:40px;border-radius:12px;display:block;"></div>
              <div class="pm-info"><div class="pm-name">Neteller</div></div>
            </div>
          </div>
          <hr class="payment-separator">
          <div class="payment-item" onclick="collapseAll()">
            <div class="payment-item-left">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;"><img src="./icons/Bancontact.svg" alt="Bancontact" style="width:40px;height:40px;border-radius:12px;display:block;"></div>
              <div class="pm-info"><div class="pm-name">Bancontact</div></div>
            </div>
          </div>
          <hr class="payment-separator">
          <div class="payment-item" onclick="collapseAll()">
            <div class="payment-item-left">
              <div class="pm-icon" style="overflow:hidden;padding:0;border:none;background:none;"><img src="./icons/UnionPay.svg" alt="UnionPay" style="width:40px;height:40px;border-radius:12px;display:block;"></div>
              <div class="pm-info"><div class="pm-name">UnionPay International</div></div>
            </div>
          </div>
          </div>
        </div>

        <!-- Show all / Show less -->
        <div class="show-all" id="showAllBtn" onclick="toggleShowAll()">
          <span id="showAllLabel">Show all payment methods</span>
          <svg id="showAllChevron" width="16" height="16" viewBox="0 0 16 16" fill="none" style="transition: transform 0.3s ease"><path d="M5 6.5L8 9.5L11 6.5" stroke="#222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
      </div>

      <!-- Trust badges -->
      <div class="trust-row">
        <div class="trust-item">
          <img src="./icons/ssl secure.svg" alt="SSL Secure" style="height:12px;width:auto;">
        </div>
        <div class="trust-item">
          <img src="./icons/pci-dss.svg" alt="PCI DSS" style="height:12px;width:auto;">
        </div>
        <div class="trust-item">
          <img src="./icons/processed by.svg" alt="Processed by ZEN.COM" style="height:12px;width:auto;">
        </div>
      </div>
    </div>

    <!-- ════════ RIGHT COLUMN ════════ -->
    <div class="right-col">

      <div class="merchant-section">
        <div class="merchant-header">
          <div class="merchant-left">
            <div class="merchant-logo">
              <img src="./icons/super-merchant-logo.svg" alt="merchant">
            </div>
            <div class="merchant-info">
              <div class="merchant-label">Payment for:</div>
              <div class="merchant-name">super-merchant.com</div>
            </div>
          </div>
          <div class="lang-toggle">EN</div>
        </div>

        <!-- Currency tabs -->
        <div class="currency-tabs" id="currencyTabs">
          <div class="currency-tabs-label">Pay in:</div>
          <div class="currency-tabs-row">
            <div class="currency-tab active" data-currency="EUR" onclick="selectCurrency(this)">EUR</div>
            <div class="currency-tab" data-currency="PLN" onclick="selectCurrency(this)">PLN</div>
            <div class="currency-tab" data-currency="GBP" onclick="selectCurrency(this)">GBP</div>
          </div>
        </div>

        <div class="total-box">
          <div class="total-top-row">
            <div class="total-label">Total to pay</div>
            <div class="total-amount">
              <span class="amount" id="totalAmount">100.00</span>
              <span class="currency" id="totalCurrency">EUR</span>
              <span class="mobile-currency-chevron" id="mobileCurrChevron"><svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M3 4.5L6 7.5L9 4.5" stroke="#222" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg></span>
            </div>
          </div>
          <div class="exchange-rate-row" id="exchangeRateRow" style="display:none">
            <span class="exchange-rate-text" id="exchangeRateText"></span>
            <a class="exchange-rate-link" href="javascript:void(0)">Margin over ECB fx rates</a>
          </div>
        </div>
      </div>

      <div class="continue-section">
        <!-- State 1: No method selected — static disabled Continue -->
        <div class="static-btn-row" id="staticBtnRow">
          <div class="static-btn disabled">
            <span>Continue</span>
          </div>
        </div>

        <!-- State 2: Method selected — spring stepper canvas -->
        <div id="stepperWrap" style="display:none; width:408px; height:60px; position:relative; flex-shrink:0;">
          <canvas id="stepperCanvas" style="width:408px; height:60px; cursor:pointer; display:block;"></canvas>
        </div>

        <div class="terms-text" id="termsText">
          By clicking "Continue" I accept <a href="javascript:void(0)"> <strong>ZEN.COM</strong> payment terms</a>
        </div>
        <div class="mobile-steps" id="mobileSteps">
          <span>●</span> Buying ZEN.COM CashCard from <a href="javascript:void(0)">distributor</a>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Bottom bar -->
<div class="bottom-bar">
  <div class="step">
    <div class="step-circle active">1</div>
    <div class="step-text">
      <div class="step-title active">Buying ZEN.COM CashCard</div>
      <div class="step-sub active">from <a href="javascript:void(0)" style="font-weight:700; text-decoration:underline; text-underline-offset:2px; color:inherit">distributor</a></div>
    </div>
  </div>
  <div class="step-divider"></div>
  <div class="step">
    <div class="step-circle inactive">2</div>
    <div class="step-text">
      <div class="step-title inactive">Payment</div>
      <div class="step-sub inactive">for super-merchant.com</div>
    </div>
  </div>
  <div class="step-divider"></div>
  <div class="step">
    <div class="step-circle inactive">3</div>
    <div class="step-text">
      <div class="step-title inactive">Status</div>
    </div>
  </div>
</div>

<script>
  // ── Mobile card detail view ──
  const isMobile = () => window.innerWidth <= 768;

  function enterMobileCardView() {
    if (isMobile()) {
      document.body.classList.add('mobile-card-view');
    }
  }

  function mobileBackToList() {
    document.body.classList.remove('mobile-card-view');
    collapseAll();
  }

  // ── Generic expand/collapse system ──
  let activeItem = null; // 'blik', 'card', or null

  const items = {
    blik: {
      wrapper: 'blikItem',
      content: 'blikExpanded',
      brands: null,
      sepBefore: null,
      sepAfter: 'sep-blik-card',
    },
    card: {
      wrapper: 'cardItem',
      content: 'cardExpanded',
      brands: null,
      sepBefore: 'sep-blik-card',
      sepAfter: 'sep-card-apple',
    }
  };

  function expandItem(id) {
    if (activeItem === id) return;

    // Collapse currently active first (instant)
    if (activeItem) {
      collapseItem(activeItem, true);
    }

    activeItem = id;
    const cfg = items[id];
    const wrapper = document.getElementById(cfg.wrapper);
    const content = document.getElementById(cfg.content);

    // Hide brands
    if (cfg.brands) {
      document.getElementById(cfg.brands).style.display = 'none';
    }

    // Fade separators
    if (cfg.sepBefore) document.getElementById(cfg.sepBefore).style.opacity = '0';
    if (cfg.sepAfter) document.getElementById(cfg.sepAfter).style.opacity = '0';

    // Expand
    wrapper.classList.add('expanded');

    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        content.classList.add('open');
      });
    });

    // Mobile: show card detail view
    if (id === 'card') enterMobileCardView();
  }

  function collapseItem(id, instant) {
    const cfg = items[id];
    if (!cfg) return;

    const wrapper = document.getElementById(cfg.wrapper);
    const content = document.getElementById(cfg.content);

    content.classList.remove('open');

    const finish = () => {
      wrapper.classList.remove('expanded');
      if (cfg.brands) {
        document.getElementById(cfg.brands).style.display = 'inline-flex';
      }
      if (cfg.sepBefore) document.getElementById(cfg.sepBefore).style.opacity = '1';
      if (cfg.sepAfter) document.getElementById(cfg.sepAfter).style.opacity = '1';
      // Reset card panels to default
      if (id === 'card') showCardPanel('saved');
    };

    if (instant) {
      finish();
    } else {
      setTimeout(finish, 450);
    }

    if (activeItem === id) activeItem = null;
  }

  function collapseAll() {
    if (activeItem) collapseItem(activeItem, false);
  }

  // ── Card panel switcher (animated) ──
  function showCardPanel(panel) {
    const panelMap = { saved: 'panelSaved', list: 'panelList', manual: 'panelManual' };
    // Remove active from all
    Object.values(panelMap).forEach(id => {
      document.getElementById(id).classList.remove('active');
    });
    // Activate target on next frame for smooth transition
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        document.getElementById(panelMap[panel]).classList.add('active');
      });
    });
  }

  // ── Choose a saved card ──
  function chooseCard(lastFour) {
    document.getElementById('activeCardNumber').textContent = '**** ' + lastFour;
    // Update current/choose labels and reorder in card list
    const list = document.querySelector('#panelList .saved-cards-list');
    const rows = Array.from(list.querySelectorAll('.saved-card-row'));
    let currentRow = null;
    rows.forEach(row => {
      const num = row.querySelector('.saved-card-number');
      const currentEl = row.querySelector('.saved-card-current');
      const chooseEl = row.querySelector('.text-link');
      if (num && num.textContent.trim() === '**** ' + lastFour) {
        currentRow = row;
        if (chooseEl) chooseEl.style.display = 'none';
        if (!currentEl) {
          const span = document.createElement('span');
          span.className = 'saved-card-current';
          span.textContent = 'Current';
          row.appendChild(span);
        } else { currentEl.style.display = ''; }
      } else {
        if (currentEl) currentEl.style.display = 'none';
        if (chooseEl) {
          chooseEl.style.display = '';
        } else {
          // Create a "Choose" link if one doesn't exist (e.g. for the initial current card)
          const digits = num ? num.textContent.trim().replace('**** ', '') : '';
          if (digits) {
            const a = document.createElement('a');
            a.className = 'text-link';
            a.href = 'javascript:void(0)';
            a.textContent = 'Choose';
            a.addEventListener('click', function(e) { e.preventDefault(); chooseCard(digits); });
            row.appendChild(a);
          }
        }
      }
    });
    // Move current card to top of list
    if (currentRow && currentRow !== list.firstElementChild) {
      list.insertBefore(currentRow, list.firstElementChild);
    }
    showCardPanel('saved');
  }

  function toggleCheckbox(id) {
    event.stopPropagation();
    const box = id === 'saveCard' ? document.getElementById('saveCardBox') : document.getElementById('saveBrowserBox');
    box.classList.toggle('checked');
  }

  function selectCurrency(el) {
    document.querySelectorAll('.currency-tab').forEach(t => t.classList.remove('active'));
    el.classList.add('active');

    // Animate amount out
    const amountEl = document.getElementById('totalAmount');
    const currencyEl = document.getElementById('totalCurrency');
    amountEl.classList.add('updating');
    currencyEl.classList.add('updating');

    const curr = el.dataset.currency;
    const baseAmount = 100.00;
    const rates = { EUR: 1, PLN: 4.4537, GBP: 0.8612 };
    const rate = rates[curr] || 1;
    const converted = (baseAmount * rate).toFixed(2);

    const totalBox = document.querySelector('.total-box');
    const rateRow = document.getElementById('exchangeRateRow');

    // After fade-out completes, update values and fade back in
    setTimeout(() => {
      amountEl.textContent = converted;
      currencyEl.textContent = curr;

      if (curr === 'EUR') {
        rateRow.style.display = 'none';
        totalBox.classList.remove('converted');
      } else {
        rateRow.style.display = 'flex';
        totalBox.classList.add('converted');
        document.getElementById('exchangeRateText').textContent = `1 EUR = ${rate.toFixed(4)} ${curr}`;
      }

      amountEl.classList.remove('updating');
      currencyEl.classList.remove('updating');
    }, 190);
  }

  // ── Card number formatting ──
  const cardInput = document.getElementById('cardNumber');
  if (cardInput) cardInput.addEventListener('input', function(e) {
    let val = this.value.replace(/\D/g, '');
    if (val.length > 16) val = val.slice(0, 16);
    let formatted = val.replace(/(.{4})/g, '$1 ').trim();
    this.value = formatted;
    updateStepperDisabled();
  });

  // ── Expiry date formatting ──
  const expiryInput = document.getElementById('expiryDate');
  if (expiryInput) expiryInput.addEventListener('input', function(e) {
    let val = this.value.replace(/\D/g, '');
    if (val.length > 4) val = val.slice(0, 4);
    if (val.length >= 2) {
      val = val.slice(0, 2) + ' / ' + val.slice(2);
    }
    this.value = val;
    updateStepperDisabled();
  });

  // ── CVV input ──
  const cvvInput = document.getElementById('cvv');
  if (cvvInput) cvvInput.addEventListener('input', function(e) {
    this.value = this.value.replace(/\D/g, '').slice(0, 4);
    updateStepperDisabled();
  });

  // ── Button, currency tabs, bottom bar visibility ──
  let stepperCurrentStep = 1;

  function updateButtonVisibility() {
    const staticRow = document.getElementById('staticBtnRow');
    const stepperWrap = document.getElementById('stepperWrap');
    const currTabs = document.getElementById('currencyTabs');
    const bottomBar = document.querySelector('.bottom-bar');

    if (activeItem) {
      staticRow.style.display = 'none';
      stepperWrap.style.display = 'block';
      currTabs.classList.add('visible');
      bottomBar.classList.add('visible');
      document.getElementById('mobileSteps')?.classList.add('visible');
      const chevron = document.getElementById('mobileCurrChevron');
      if (chevron) chevron.classList.add('visible');
      document.querySelector('.total-amount')?.classList.add('has-dropdown');
      updateTermsText();
      // Redraw canvas after layout update (double rAF for reliable sizing)
      requestAnimationFrame(() => { requestAnimationFrame(() => drawStepper()); });
    } else {
      staticRow.style.display = 'flex';
      stepperWrap.style.display = 'none';
      currTabs.classList.remove('visible');
      bottomBar.classList.remove('visible');
      document.getElementById('mobileSteps')?.classList.remove('visible');
      const chevron = document.getElementById('mobileCurrChevron');
      if (chevron) chevron.classList.remove('visible');
      document.querySelector('.total-amount')?.classList.remove('has-dropdown');
      document.getElementById('termsText').innerHTML = 'By clicking "Continue" I accept <a href="javascript:void(0)"> <strong>ZEN.COM</strong> payment terms</a>';
      resetCurrency();
      stepperCurrentStep = 1;
      stepper.step = 1;
      stepper.target = 0;
      stepper.value = 0;
      stepper.velocity = 0;
      stepper.running = false;
      drawStepper();
    }
    updateStepperDisabled();
  }

  function updateTermsText() {
    const t = document.getElementById('termsText');
    if (stepperCurrentStep === 2) {
      t.innerHTML = 'By clicking "confirm payment" I accept <a href="javascript:void(0)"> <strong>ZEN.COM</strong> terms</a>';
    } else {
      t.innerHTML = 'By clicking "accept order" I accept <a href="javascript:void(0)"> <strong>ZEN.COM</strong> CashCard distributor terms</a>';
    }
  }

  function resetCurrency() {
    document.querySelectorAll('.currency-tab').forEach(t => t.classList.remove('active'));
    document.querySelector('.currency-tab[data-currency="EUR"]').classList.add('active');
    document.getElementById('totalAmount').textContent = '100.00';
    document.getElementById('totalCurrency').textContent = 'EUR';
    document.getElementById('exchangeRateRow').style.display = 'none';
    document.querySelector('.total-box').classList.remove('converted');
  }

  // ── Show all / Show less ──
  let showAllOpen = false;
  function toggleShowAll() {
    showAllOpen = !showAllOpen;
    document.getElementById('extraMethods').classList.toggle('open', showAllOpen);
    document.getElementById('showAllLabel').textContent = showAllOpen ? 'Show less' : 'Show all payment methods';
    document.getElementById('showAllChevron').style.transform = showAllOpen ? 'rotate(180deg)' : '';
    if (showAllOpen) {
      setTimeout(() => {
        document.getElementById('showAllBtn').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }
  }

  function updateStepperDisabled() {
    const cardExpanded = activeItem === 'card';
    const manualActive = document.getElementById('panelManual').classList.contains('active');
    if (cardExpanded && manualActive) {
      const num = cardInput ? cardInput.value.replace(/\s/g, '') : '';
      const exp = expiryInput ? expiryInput.value.replace(/\D/g, '') : '';
      const cvv = cvvInput ? cvvInput.value : '';
      stepper.disabled = !(num.length >= 15 && exp.length === 4 && cvv.length >= 3);
    } else {
      stepper.disabled = false;
    }
    drawStepper();
  }

  // Hook into expand/collapse/panel to update button
  const _origExpand = expandItem;
  expandItem = function(id) { _origExpand(id); setTimeout(updateButtonVisibility, 50); };
  const _origCollapseAll = collapseAll;
  collapseAll = function() {
    document.body.classList.remove('mobile-card-view');
    _origCollapseAll();
    setTimeout(updateButtonVisibility, 500);
  };
  const _origShowPanel = showCardPanel;
  showCardPanel = function(p) { _origShowPanel(p); setTimeout(updateStepperDisabled, 50); };

  // ── Spring Stepper (Canvas) ──
  const CONN_PATH = new Path2D("M7.55762 0C9.24192 3.14729 12.5597 5.28906 16.3789 5.28906C20.1981 5.28906 23.5159 3.14729 25.2002 0H32V39H25.248C23.5797 35.8019 20.2357 33.6172 16.3789 33.6172C12.5222 33.6172 9.17806 35.8019 7.50977 39H0V0H7.55762Z");
  const H = 60, CIR = 60, CON = 32, OV = 15;
  const BADGE = 25, FONT = 17, BFONT = 14;

  function getStepperWidth() {
    const wrap = document.getElementById('stepperWrap');
    return wrap.offsetWidth || 408;
  }

  const lerp = (a, b, t) => a + (b - a) * t;
  const clamp = (v, lo = 0, hi = 1) => Math.max(lo, Math.min(hi, v));
  function lerpC(c1, c2, t) {
    t = clamp(t);
    const p = (s, i) => parseInt(s.slice(i, i + 2), 16);
    return [Math.round(lerp(p(c1,1),p(c2,1),t)), Math.round(lerp(p(c1,3),p(c2,3),t)), Math.round(lerp(p(c1,5),p(c2,5),t))];
  }

  const canvas = document.getElementById('stepperCanvas');
  const ctx = canvas.getContext('2d');

  // roundRect polyfill for iOS Safari
  if (!ctx.roundRect) {
    CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, radii) {
      const r = Array.isArray(radii) ? radii[0] : (radii || 0);
      this.moveTo(x + r, y);
      this.lineTo(x + w - r, y);
      this.arcTo(x + w, y, x + w, y + r, r);
      this.lineTo(x + w, y + h - r);
      this.arcTo(x + w, y + h, x + w - r, y + h, r);
      this.lineTo(x + r, y + h);
      this.arcTo(x, y + h, x, y + h - r, r);
      this.lineTo(x, y + r);
      this.arcTo(x, y, x + r, y, r);
      this.closePath();
    };
  }

  let lastCanvasW = 0;

  function resizeCanvas() {
    const W = getStepperWidth();
    if (W === lastCanvasW) return;
    lastCanvasW = W;
    const S = 2;
    canvas.width = W * S;
    canvas.height = H * S;
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
  }

  const stepper = {
    step: 1, target: 0, value: 0, velocity: 0, disabled: false, hovered: false,
    stiffness: 300, damping: 20, mass: 1, lastTime: null, running: false
  };

  canvas.addEventListener('click', () => {
    if (stepper.disabled) return;
    if (stepper.step === 2) {
      // Step 2 = "Confirm Payment" — save payment info and navigate to status page
      const paymentData = { method: activeItem };
      if (activeItem === 'card') {
        const rawCard = (document.getElementById('cardNumber')?.value || '').replace(/\s/g, '');
        paymentData.cardLast4 = rawCard.length >= 4 ? rawCard.slice(-4) : '????';
        // Detect card brand from first digit
        const firstDigit = rawCard[0] || '';
        if (firstDigit === '4') paymentData.cardBrand = 'Visa';
        else if (firstDigit === '5' || firstDigit === '2') paymentData.cardBrand = 'Mastercard';
        else paymentData.cardBrand = 'Card';
      }
      paymentData.currency = document.getElementById('totalCurrency')?.textContent || 'EUR';
      paymentData.amount = document.getElementById('totalAmount')?.textContent || '100.00';
      try { sessionStorage.setItem('zenPaymentData', JSON.stringify(paymentData)); } catch(e) {}
      window.parent.postMessage({ type: 'navigate', to: '/status' }, '*');
      return;
    }
    stepper.step = 2;
    stepper.target = 1;
    stepperCurrentStep = 2;
    updateTermsText();
    startSpring();
  });
  canvas.addEventListener('mouseenter', () => { stepper.hovered = true; drawStepper(); });
  canvas.addEventListener('mouseleave', () => { stepper.hovered = false; drawStepper(); });

  function startSpring() {
    if (stepper.running) return;
    stepper.running = true;
    stepper.lastTime = null;
    requestAnimationFrame(springStep);
  }

  function springStep(ts) {
    if (stepper.lastTime === null) { stepper.lastTime = ts; requestAnimationFrame(springStep); return; }
    const dt = Math.min((ts - stepper.lastTime) / 1000, 0.064);
    stepper.lastTime = ts;
    const disp = stepper.value - stepper.target;
    stepper.velocity += ((-stepper.stiffness * disp - stepper.damping * stepper.velocity) / stepper.mass) * dt;
    stepper.value += stepper.velocity * dt;
    if (Math.abs(stepper.velocity) < 0.001 && Math.abs(disp) < 0.001) {
      stepper.value = stepper.target;
      stepper.velocity = 0;
      stepper.running = false;
      drawStepper();
      return;
    }
    drawStepper();
    requestAnimationFrame(springStep);
  }

  function drawStepper() {
    resizeCanvas();
    const W = lastCanvasW || 408;
    const PW = W - CIR - CON + OV * 2;
    const S = 2;
    ctx.clearRect(0, 0, W * S, H * S);
    ctx.save();
    ctx.scale(S, S);

    const p = stepper.value;
    const cp = clamp(p);
    const dis = stepper.disabled;

    // Derived values
    const aW = lerp(PW, CIR, p);
    const aBg = dis && cp < 0.5 ? lerpC("#E5E5E5", "#E5E5E5", 0) : lerpC("#F7F7F7", "#22E243", cp);
    const bW = lerp(CIR, PW, p);
    const bL = lerp(W - CIR, W - PW, p);
    const bBg = cp <= 0.5 ? lerpC("#F7F7F7", "#222222", cp * 2) : lerpC("#222222", "#22E243", (cp - 0.5) * 2);
    const cL = lerp(PW - OV, CIR - OV, p);
    const cC = dis && cp < 0.5 ? lerpC("#E5E5E5", "#E5E5E5", 0) : lerpC("#F7F7F7", "#22E243", cp);

    const aPill = cp < 0.3 ? lerp(1, 0, cp / 0.3) : 0;
    const aCheck = cp > 0.5 ? lerp(0, 1, (cp - 0.5) / 0.5) : 0;
    const bBadge = cp < 0.3 ? lerp(1, 0, cp / 0.3) : 0;
    const bPill = cp > 0.5 ? lerp(0, 1, (cp - 0.5) / 0.5) : 0;

    const rgb = (c) => `rgb(${c[0]},${c[1]},${c[2]})`;

    // Connector (z-index: 1 — behind both pills)
    ctx.save();
    ctx.translate(cL, (H - 39) / 2);
    ctx.fillStyle = rgb(cC);
    ctx.fill(CONN_PATH);
    ctx.restore();

    // Element A: pill / green circle (z-index: 2)
    ctx.save();
    ctx.beginPath();
    ctx.roundRect(0, 0, aW, H, [100]);
    ctx.clip();
    ctx.fillStyle = rgb(aBg);
    ctx.fill();

    // A pill content
    if (aPill > 0.01) {
      ctx.globalAlpha = aPill;
      ctx.beginPath();
      ctx.roundRect(2, 2, aW - 4, H - 4, [100]);
      ctx.fillStyle = dis ? '#B5B5B5' : '#222';
      ctx.fill();
      // Badge "1"
      const bx = aW / 2 - 60, by = H / 2;
      ctx.beginPath();
      ctx.arc(bx, by, BADGE / 2, 0, Math.PI * 2);
      ctx.fillStyle = stepper.hovered && !dis ? 'rgba(255,255,255,0.30)' : 'rgba(255,255,255,0.10)';
      ctx.fill();
      ctx.strokeStyle = stepper.hovered && !dis ? 'rgba(255,255,255,0.40)' : 'rgba(255,255,255,0.20)';
      ctx.lineWidth = 1;
      ctx.stroke();
      ctx.fillStyle = '#fff';
      ctx.font = `700 ${BFONT}px Nunito, sans-serif`;
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      ctx.fillText('1', bx, by + 1);
      // Label
      ctx.font = `700 ${FONT}px Nunito, sans-serif`;
      ctx.fillText('Accept order', aW / 2 + 8, H / 2 + 1);
      ctx.globalAlpha = 1;
    }

    // A check
    if (aCheck > 0.01) {
      ctx.globalAlpha = aCheck;
      const cx2 = aW / 2, cy = H / 2;
      ctx.beginPath(); ctx.arc(cx2, cy, 13, 0, Math.PI * 2);
      ctx.fillStyle = '#222'; ctx.fill();
      ctx.strokeStyle = '#222'; ctx.lineWidth = 2; ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(cx2 - 5, cy + 0.5); ctx.lineTo(cx2 - 1.5, cy + 4); ctx.lineTo(cx2 + 5, cy - 3);
      ctx.strokeStyle = '#22E243'; ctx.lineWidth = 2.5;
      ctx.lineCap = 'round'; ctx.lineJoin = 'round'; ctx.stroke();
      ctx.globalAlpha = 1;
    }
    ctx.restore();

    // Element B: circle / pill (z-index: 2)
    ctx.save();
    ctx.beginPath();
    ctx.roundRect(bL, 0, bW, H, [100]);
    ctx.clip();
    ctx.fillStyle = rgb(bBg);
    ctx.fill();

    // B badge "2" (inactive)
    if (bBadge > 0.01) {
      ctx.globalAlpha = bBadge;
      const bx = bL + bW / 2, by = H / 2;
      ctx.beginPath(); ctx.arc(bx, by, BADGE / 2, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(255,255,255,0.20)'; ctx.fill();
      ctx.strokeStyle = '#B5B5B5'; ctx.lineWidth = 1; ctx.stroke();
      ctx.fillStyle = '#B5B5B5';
      ctx.font = `700 ${BFONT}px Nunito, sans-serif`;
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      ctx.fillText('2', bx, by + 1);
      ctx.globalAlpha = 1;
    }

    // B pill content
    if (bPill > 0.01) {
      ctx.globalAlpha = bPill;
      ctx.beginPath();
      ctx.roundRect(bL + 2, 2, bW - 4, H - 4, [100]);
      ctx.fillStyle = '#222'; ctx.fill();
      const bCenterX = bL + bW / 2;
      const bx = bCenterX - 80, by = H / 2;
      ctx.beginPath(); ctx.arc(bx, by, BADGE / 2, 0, Math.PI * 2);
      ctx.fillStyle = stepper.hovered ? 'rgba(255,255,255,0.30)' : 'rgba(255,255,255,0.10)';
      ctx.fill();
      ctx.strokeStyle = stepper.hovered ? 'rgba(255,255,255,0.40)' : 'rgba(255,255,255,0.20)';
      ctx.lineWidth = 1; ctx.stroke();
      ctx.fillStyle = '#fff';
      ctx.font = `700 ${BFONT}px Nunito, sans-serif`;
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      ctx.fillText('2', bx, by + 1);
      ctx.font = `700 ${FONT}px Nunito, sans-serif`;
      ctx.fillText('Confirm Payment', bCenterX + 10, H / 2 + 1);
      ctx.globalAlpha = 1;
    }
    ctx.restore();

    ctx.restore();

    // Update cursor
    canvas.style.cursor = dis ? 'not-allowed' : 'pointer';
  }

  // Initial draw
  resizeCanvas();
  drawStepper();

  // Resize canvas on window resize
  window.addEventListener('resize', () => {
    if (document.getElementById('stepperWrap').style.display !== 'none') {
      drawStepper();
    }
  });
</script>

</body>
</html>
